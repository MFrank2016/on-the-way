# 新功能使用指南

## 🎉 新增功能概览

本次更新为待办事项系统添加了以下核心功能：
1. **文件夹层级管理** - 多层级文件夹组织清单
2. **清单归属系统** - 清单可归属到文件夹或独立存在
3. **重复任务** - 支持9种重复模式的自动任务生成
4. **时间管理** - 截止时间、提醒时间设置
5. **默认收集箱** - 注册时自动创建

---

## 📁 文件夹管理

### 创建文件夹
1. 在侧边栏"清单"标题右侧点击 **文件夹+** 图标
2. 输入文件夹名称
3. 选择父文件夹（可选，支持多层级）
4. 选择图标和颜色
5. 点击"创建"

### 管理文件夹
- **编辑**: 右键点击文件夹 → 选择"编辑"
- **删除**: 右键点击文件夹 → 选择"删除"
  - 删除文件夹时，其中的清单会移到顶层
  - 子文件夹会移到父级或顶层
- **展开/折叠**: 点击文件夹旁的箭头图标

---

## 📋 清单管理

### 默认收集箱
- 注册新用户时自动创建
- 不可删除（系统清单）
- 创建任务时未指定清单会默认使用收集箱

### 创建清单
（功能开发中，当前显示占位符）

### 清单归属
- 清单可以归属到任意文件夹
- 清单也可以独立存在（不归属任何文件夹）
- 通过右键菜单可以移动清单

---

## ✅ 任务管理

### 创建任务

#### 基本信息
1. 点击页面中的"+"按钮
2. 输入**任务标题**（必填）
3. 添加**描述**（可选）

#### 清单选择
- 选择任务所属的清单
- 下拉框会显示所有可用清单
- 如果不选择，默认放入收集箱

#### 优先级设置（四象限）
选择以下四种优先级之一：
- **不重要不紧急** - 灰色
- **不重要但紧急** - 黄色
- **重要不紧急** - 蓝色
- **重要且紧急** - 红色

#### 截止时间
1. 点击"设置截止时间"
2. 选择快捷日期（今天、明天、下周等）
3. 或点击日期打开完整日历
4. 选择时间（提供快捷时间或自定义）

#### 提醒时间
1. 必须先设置截止时间
2. 选择相对于截止时间的提醒：
   - 准时
   - 提前5分钟
   - 提前30分钟
   - 提前1小时
   - 提前1天
   - 自定义时间

#### 重复模式
点击"不重复"按钮，选择重复类型：

**基础重复**
- **每天** - 每天重复，可设置间隔天数
- **每周** - 选择星期几，可设置间隔周数
- **每月** - 选择每月第几天，可设置间隔月数
- **每年** - 每年重复，可设置间隔年数

**特殊重复**
- **工作日** - 周一至周五每天重复
- **节假日** - 每个周末重复
- **农历每月** - 按农历月份重复
- **农历每年** - 按农历年份重复
- **自定义** - 自定义间隔天数

**重复配置**
- 设置重复间隔（如每2天、每3周等）
- 每周重复可选择具体星期几
- 每月重复可指定具体日期
- 农历重复需输入农历日期（格式：MM-DD）
- 可选设置重复结束日期

### 完成重复任务
- 点击任务的勾选框完成任务
- 如果是重复任务，系统会自动生成下一个任务实例
- 新任务保留原任务的所有属性
- 截止日期根据重复规则自动计算
- 提醒时间相对于新截止日期自动调整

---

## 🎯 使用场景示例

### 场景1：组织工作项目
```
文件夹：工作
├── 文件夹：项目A
│   ├── 清单：需求分析
│   ├── 清单：开发任务
│   └── 清单：测试计划
└── 文件夹：项目B
    ├── 清单：设计稿
    └── 清单：开发任务
```

### 场景2：每日习惯打卡
1. 创建任务"晨跑"
2. 设置重复：每天
3. 设置提醒：早上6:00
4. 完成任务后自动生成明天的任务

### 场景3：周期性工作
1. 创建任务"周报"
2. 设置重复：每周（选择周五）
3. 设置截止时间：周五18:00
4. 设置提醒：提前1天
5. 每周五18:00前会收到提醒

### 场景4：按农历提醒
1. 创建任务"给奶奶打电话"
2. 设置重复：农历每月（01-01，即每月初一）
3. 按农历日期自动重复

---

## ⚡ 快捷操作

### 侧边栏
- **展开/折叠清单区域**: 点击"清单"标题
- **新建文件夹**: 点击文件夹+图标
- **新建清单**: 点击清单+图标
- **右键菜单**: 右键点击文件夹/清单进行编辑或删除

### 任务对话框
- **Tab键**: 在输入框间切换
- **Esc键**: 关闭对话框
- **Enter键**: 保存任务（标题输入框中）

---

## 📱 注意事项

### 系统清单
- 默认收集箱是**系统清单**，不可删除
- 确保始终有一个默认清单用于接收任务

### 重复任务
- 重复任务完成后自动生成新实例
- 如果设置了结束日期，到期后不再生成
- 工作日重复：周一至周五
- 节假日重复：周六和周日（未来可接入节假日API）

### 文件夹删除
- 删除文件夹时，子文件夹和清单不会被删除
- 子内容会自动移到上一级或顶层

### 提醒时间
- 提醒时间必须早于或等于截止时间
- 提醒功能需要系统支持（当前为数据存储）

---

## 🔧 技术说明

### 数据存储
- 所有数据存储在本地 SQLite 数据库
- 数据库文件：`backend/data.db`
- 支持自动迁移，启动时自动更新表结构

### API 端点
```
文件夹管理：
GET    /api/folders
POST   /api/folders
PUT    /api/folders/:id
DELETE /api/folders/:id
PUT    /api/folders/:id/move
PUT    /api/folders/:id/toggle

清单管理：
PUT    /api/lists/:id/move

任务管理：（已包含重复任务字段）
POST   /api/tasks
PUT    /api/tasks/:id
PUT    /api/tasks/:id/complete
```

---

## 🐛 问题反馈

如遇到问题，请检查：
1. 后端服务是否正常运行（端口8080）
2. 前端服务是否正常运行（端口3000）
3. 浏览器控制台是否有错误信息
4. 数据库文件是否有写权限

---

## 📈 未来计划

- [ ] 拖拽排序功能完善
- [ ] 清单编辑对话框完善
- [ ] 接入真实节假日API
- [ ] 接入农历计算库
- [ ] 任务标签系统
- [ ] 任务搜索增强
- [ ] 键盘快捷键支持
- [ ] 深色模式
- [ ] 移动端适配优化

---

**享受新功能，提升您的效率！** 🚀

